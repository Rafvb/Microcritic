{"ts":1375647320293,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var ReviewProvider = require('./reviewprovider').ReviewProvider;\nvar reviewProvider = new ReviewProvider();\n\nvar MovieDataProvider = require('./moviedataprovider').MovieDataProvider;\nvar movieDataProvider = new MovieDataProvider();\n\n/* \n\tShow (movie/:id)\n\tList (movies)\n\tEdit (movie/:id/edit)\n\tUpdate (movie/:id = put)\n\tNew (movie/new)\n\tCreate (movie post)\n\tIndex (/)\n*/\n\nexports.show = function(req, res){\n\treviewProvider.findByImdbId(req.params.imdbId, function(error, movies){\n      var movie = movies[0];\n      \n      console.log('Showing the following item: ');\n      console.log(movie);\n      console.log('');\n      \n      res.render('movie_show.jade', {\n\t\ttitle: movie.title,\n\t\tmovie: movie\n      });\n\t});\n};\n\nexports.new = function(req, res){\t\n  res.render('movie_new.jade', {\n    title: 'New movie'\n  });\n};\n\nexports.create = function(req, res){\n    movieDataProvider.getMovieData(req.param('imdbId'), function(error, movieData){\n        reviewProvider.save({\n          imdbId: movieData.imdbId,\n          title: movieData.title,\n          director: movieData.director,\n          year: movieData.year,\n          poster: movieData.poster,\n          reviews: [{\n            body: req.param('body'),\n            author: req.param('author'),\n            good: req.param('good')\n          }]\n        }, function(error, movieDetails) {\n          res.redirect('/movie/' + movieDetails[0].imdbId);\n        });\n    });\n};"]],"start1":0,"start2":0,"length1":0,"length2":1421}]],"length":1421}
{"contributors":[],"silentsave":false,"ts":1375647323151,"patch":[[{"diffs":[[0,"quire('."],[1,"./providers"],[0,"/reviewp"]],"start1":23,"start2":23,"length1":16,"length2":27}]],"length":1432,"saved":false}
{"ts":1375647333312,"patch":[[{"diffs":[[0,"Provider"],[-1,";\nvar"],[1,",\n   "],[0," reviewP"]],"start1":66,"start2":66,"length1":21,"length2":21}]],"length":1432,"saved":false}
{"ts":1375647359396,"patch":[[{"diffs":[[0,"er()"],[-1,";\n\nvar"],[1,",\n    \n   "],[0," Mov"]],"start1":113,"start2":113,"length1":14,"length2":18},{"diffs":[[0,"ovider;\n"],[-1,"var"],[1,"   "],[0," movieDa"]],"start1":190,"start2":190,"length1":19,"length2":19}]],"length":1436,"saved":false}
{"ts":1375647382003,"patch":[[{"diffs":[[0,"Provider"],[-1,";"],[1,","],[0,"\n    mov"]],"start1":188,"start2":188,"length1":17,"length2":17}]],"length":1436,"saved":false}
{"ts":1375647388899,"patch":[[{"diffs":[[0,"quire('."],[1,"./providers"],[0,"/movieda"]],"start1":150,"start2":150,"length1":16,"length2":27}]],"length":1447,"saved":false}
{"ts":1375647502552,"patch":[[{"diffs":[[0,"Provider"],[-1,","],[0,"\n  "],[-1," "],[1,","],[0," reviewP"]],"start1":66,"start2":66,"length1":21,"length2":20},{"diffs":[[0,"er()"],[-1,",\n  "],[1,"\n"],[0,"  \n  "],[-1," "],[1,","],[0," Mov"]],"start1":112,"start2":112,"length1":18,"length2":15},{"diffs":[[0,"Provider"],[-1,","],[0,"\n  "],[-1," "],[1,","],[0," movieDa"]],"start1":195,"start2":195,"length1":21,"length2":20}]],"length":1442,"saved":false}
{"contributors":[],"silentsave":false,"ts":1375693579666,"patch":[[{"diffs":[[0,"eq, res)"],[1," "],[0,"{\n\trevie"]],"start1":418,"start2":418,"length1":16,"length2":17},{"diffs":[[0," movies)"],[1," "],[0,"{\n"],[-1,"  "],[0,"    var "]],"start1":492,"start2":492,"length1":20,"length2":19},{"diffs":[[0,"\n      \n    "],[-1,"  "],[0,"console.log("]],"start1":529,"start2":529,"length1":26,"length2":24},{"diffs":[[0,"g item: ');\n"],[-1,"  "],[0,"    console."]],"start1":574,"start2":574,"length1":26,"length2":24},{"diffs":[[0,"e);\n    "],[-1,"  "],[0,"console."]],"start1":606,"start2":606,"length1":18,"length2":16},{"diffs":[[0,"\n      \n"],[-1,"  "],[0,"    res."]],"start1":630,"start2":630,"length1":18,"length2":16},{"diffs":[[0,"ade', {\n"],[-1,"\t\t"],[1,"      "],[0,"title: m"]],"start1":666,"start2":666,"length1":18,"length2":22},{"diffs":[[0,"le,\n"],[-1,"\t\t"],[1,"      "],[0,"movi"]],"start1":696,"start2":696,"length1":10,"length2":14},{"diffs":[[0,": movie\n"],[-1,"  "],[0,"    });\n"]],"start1":711,"start2":711,"length1":18,"length2":16}]],"length":1440,"saved":false}
{"ts":1375693670186,"patch":[[{"diffs":[[0,"res)"],[1," "],[0,"{\t\n"],[-1,""],[0,"  re"]],"start1":764,"start2":764,"length1":11,"length2":12},{"diffs":[[0,"eq, res)"],[1," "],[0,"{\n"],[-1,"  "],[0,"  movieD"]],"start1":865,"start2":865,"length1":20,"length2":19},{"diffs":[[0,"vieData)"],[1," "],[0,"{\n"],[-1,"    "],[0,"    revi"]],"start1":948,"start2":948,"length1":22,"length2":19},{"diffs":[[0,"{\n      "],[-1,"  "],[-1,"  "],[0,"imdbId: "]],"start1":983,"start2":983,"length1":20,"length2":16},{"diffs":[[0,"imdbId,\n"],[-1,"    "],[0,"      ti"]],"start1":1009,"start2":1009,"length1":20,"length2":16},{"diffs":[[0,",\n      "],[-1,"    "],[0,"director"]],"start1":1045,"start2":1045,"length1":20,"length2":16},{"diffs":[[0,"rector,\n"],[-1,"    "],[0,"      ye"]],"start1":1075,"start2":1075,"length1":20,"length2":16},{"diffs":[[0,",\n      "],[-1,"    "],[0,"poster: "]],"start1":1109,"start2":1109,"length1":20,"length2":16},{"diffs":[[0,",\n      "],[-1,"   "],[-1," "],[0,"reviews:"]],"start1":1141,"start2":1141,"length1":20,"length2":16},{"diffs":[[0,"ews: [{\n"],[-1,"    "],[0,"        "]],"start1":1153,"start2":1153,"length1":20,"length2":16},{"diffs":[[0,"        "],[-1,"   "],[-1," "],[0,"author: "]],"start1":1194,"start2":1194,"length1":20,"length2":16},{"diffs":[[0,"        "],[-1,"    "],[0,"good: re"]],"start1":1231,"start2":1231,"length1":20,"length2":16},{"diffs":[[0,"    "],[-1,"   "],[-1," "],[0,"}]\n"],[-1,"    "],[0,"    "]],"start1":1265,"start2":1265,"length1":19,"length2":11},{"diffs":[[0,"{\n      "],[-1,"   "],[-1," "],[0,"res.redi"]],"start1":1309,"start2":1309,"length1":20,"length2":16},{"diffs":[[0,"d);\n"],[-1,"    "],[0,"    });\n"],[-1,"  "],[0,"  })"]],"start1":1363,"start2":1363,"length1":22,"length2":16}]],"length":1383,"saved":false}
{"contributors":[],"silentsave":false,"ts":1375729806461,"patch":[[{"diffs":[[0,"{\n  "],[-1,"movieDataProvider.getMovieData(req.param('imdbId'), function(error, movieData) {\n    reviewProvider.save({\n  "],[1,"var newReview = {\n"],[0,"    "]],"start1":874,"start2":874,"length1":117,"length2":26},{"diffs":[[0,"imdbId,\n    "],[-1,"  "],[0,"title: movie"]],"start1":918,"start2":918,"length1":26,"length2":24},{"diffs":[[0,"Data.title,\n"],[-1,"  "],[0,"    director"]],"start1":942,"start2":942,"length1":26,"length2":24},{"diffs":[[0,"or,\n    "],[-1,"  "],[0,"year: mo"]],"start1":984,"start2":984,"length1":18,"length2":16},{"diffs":[[0,"a.year,\n"],[-1,"  "],[0,"    post"]],"start1":1006,"start2":1006,"length1":18,"length2":16},{"diffs":[[0,"er,\n    "],[-1,"  "],[0,"reviews:"]],"start1":1040,"start2":1040,"length1":18,"length2":16},{"diffs":[[0,"ews: [{\n"],[-1,"  "],[0,"      bo"]],"start1":1052,"start2":1052,"length1":18,"length2":16},{"diffs":[[0,",\n      "],[-1,"  "],[0,"author: "]],"start1":1089,"start2":1089,"length1":18,"length2":16},{"diffs":[[0,"('author'),\n"],[-1,"  "],[0,"      good: "]],"start1":1114,"start2":1114,"length1":26,"length2":24},{"diffs":[[0,"    "],[1,"}]\n"],[0,"  }"],[-1,"]"],[1,";"],[0,"\n  "],[1,"\n"],[0,"  "],[-1,"}"],[1,"movieDataProvider.getMovieData(req.param('imdbId')"],[0,", fu"]],"start1":1156,"start2":1156,"length1":18,"length2":71},{"diffs":[[0,", movieD"],[-1,"etails"],[1,"ata) {\n\n    \n    reviewProvider.save(newReview, function(error, review"],[0,") {\n    "]],"start1":1239,"start2":1239,"length1":22,"length2":86},{"diffs":[[0,"' + "],[-1,"movieDetails[0]"],[1,"review"],[0,".imd"]],"start1":1348,"start2":1348,"length1":23,"length2":14}]],"length":1384,"saved":false}
{"ts":1375729817885,"patch":[[{"diffs":[[0,"Id: "],[-1,"movieData."],[1,"req.param('"],[0,"imdbId"],[1,"')"],[0,",\n  "]],"start1":904,"start2":904,"length1":24,"length2":27}]],"length":1387,"saved":false}
{"ts":1375729838564,"patch":[[{"diffs":[[0,"'),\n"],[-1,"    title: movieData.title,\n    director: movieData.director,\n    year: movieData.year,\n    poster: movieData.poster,\n"],[0,"    "]],"start1":925,"start2":925,"length1":126,"length2":8}]],"length":1269,"saved":false}
{"ts":1375729844333,"patch":[[{"diffs":[[0,"vieData("],[-1,"req.param('imdbId')"],[1,"newReview"],[0,", functi"]],"start1":1081,"start2":1081,"length1":35,"length2":25}]],"length":1259,"saved":false}
{"ts":1375729845939,"patch":[[{"diffs":[[0,"eData) {"],[-1,"\n\n"],[0,"    \n   "]],"start1":1120,"start2":1120,"length1":18,"length2":16}]],"length":1257,"saved":false}
{"ts":1375729850933,"patch":[[{"diffs":[[0,"er.save("],[-1,"newReview"],[1,"movieData"],[0,", functi"]],"start1":1149,"start2":1149,"length1":25,"length2":25}]],"length":1257,"saved":false}
{"ts":1375729856567,"patch":[[{"diffs":[[0,"(error, "],[-1,"movieData"],[1,"newReview"],[0,") {    \n"]],"start1":1108,"start2":1108,"length1":25,"length2":25}]],"length":1257,"saved":false}
{"ts":1375729862654,"patch":[[{"diffs":[[0,"er.save("],[-1,"movieData"],[1,"newReview"],[0,", functi"]],"start1":1149,"start2":1149,"length1":25,"length2":25}]],"length":1257,"saved":false}
{"ts":1375729881473,"patch":[[{"diffs":[[0,"{\n  var "],[-1,"newR"],[1,"r"],[0,"eview = "]],"start1":874,"start2":874,"length1":20,"length2":17},{"diffs":[[0,"vieData("],[-1,"newR"],[1,"r"],[0,"eview, f"]],"start1":1078,"start2":1078,"length1":20,"length2":17},{"diffs":[[0,"(error, "],[-1,"newR"],[1,"r"],[0,"eview) {"]],"start1":1102,"start2":1102,"length1":20,"length2":17},{"diffs":[[0,"ave("],[-1,"newR"],[1,"r"],[0,"evie"]],"start1":1144,"start2":1144,"length1":12,"length2":9}]],"length":1245,"saved":false}
{"ts":1375729890622,"patch":[[{"diffs":[[0,"der."],[-1,"get"],[1,"add"],[0,"Movi"]],"start1":1069,"start2":1069,"length1":11,"length2":11}]],"length":1245,"saved":false}
{"contributors":[],"silentsave":false,"ts":1375992326008,"patch":[[{"diffs":[[0,"    });\n  });\n};"],[1,"\n\n\nexports.edit = function(req, res) {\n  var review = {\n    imdbId: req.param('imdbId'),\n    reviews: [{\n      body: req.param('body'),\n      author: req.param('author'),\n      good: req.param('good')\n    }]\n  };\n  \n  movieDataProvider.addMovieData(review, function(error, review) {    \n    reviewProvider.save(review, function(error, review) {\n      res.redirect('/movie/' + review.imdbId);\n    });\n  });\n};"]],"start1":1229,"start2":1229,"length1":16,"length2":424}]],"length":1653,"saved":false}
{"ts":1375992443502,"patch":[[{"diffs":[[0,"= {\n"],[-1,"    imdbId: req.param('imdbId'),\n    reviews: [{\n  "],[0,"    "]],"start1":1297,"start2":1297,"length1":59,"length2":8},{"diffs":[[0,"am('body'),\n    "],[-1,"  "],[0,"author: req.para"]],"start1":1318,"start2":1318,"length1":34,"length2":32},{"diffs":[[0,"('author'),\n    "],[-1,"  "],[0,"good: req.param("]],"start1":1351,"start2":1351,"length1":34,"length2":32},{"diffs":[[0,"q.param('good')\n"],[-1,"    }]\n"],[0,"  };\n  \n  movieD"]],"start1":1375,"start2":1375,"length1":39,"length2":32},{"diffs":[[0,"er.addMovieData("],[-1,"review"],[0,", function(error"]],"start1":1416,"start2":1416,"length1":38,"length2":32},{"diffs":[[0,"ewProvider.save("],[1,"req.param('imdbId'), "],[0,"review, function"]],"start1":1472,"start2":1472,"length1":32,"length2":53}]],"length":1606,"saved":false}
{"ts":1375992457679,"patch":[[{"diffs":[[0,")\n  };\n  \n  "],[-1,"movieData"],[1,"review"],[0,"Provider.add"]],"start1":1389,"start2":1389,"length1":33,"length2":30},{"diffs":[[0,".add"],[-1,"MovieData(, function(error, review) {    \n    reviewProvider.sav"],[1,"ReviewToMovi"],[0,"e(re"]],"start1":1415,"start2":1415,"length1":72,"length2":20},{"diffs":[[0,", review) {\n    "],[-1,"  "],[0,"res.redirect('/m"]],"start1":1476,"start2":1476,"length1":34,"length2":32},{"diffs":[[0,"ew.imdbId);\n"],[-1,"    });\n"],[0,"  });\n};"]],"start1":1521,"start2":1521,"length1":28,"length2":20}]],"length":1541,"saved":false}
{"ts":1375992477268,"patch":[[{"diffs":[[0,"exports."],[-1,"edit"],[1,"addReview"],[0," = funct"]],"start1":1248,"start2":1248,"length1":20,"length2":25}]],"length":1546,"saved":false}
{"ts":1375993304487,"patch":[[{"diffs":[[0,"movie/' + re"],[-1,"view."],[1,"q.param('"],[0,"imdbId"],[1,"')"],[0,");\n  });\n};"]],"start1":1512,"start2":1512,"length1":34,"length2":40}]],"length":1552,"saved":false}
{"ts":1375993559903,"patch":[[{"diffs":[[0,"ion(req, res) {\n"],[1,"  var imdbId = req.param('imdbId');\n  \n"],[0,"  var review = {"]],"start1":1273,"start2":1273,"length1":32,"length2":71}]],"length":1591,"saved":false}
{"ts":1375993566557,"patch":[[{"diffs":[[0,"mdbId');"],[-1,"\n"],[0,"  \n  var"]],"start1":1316,"start2":1316,"length1":17,"length2":16},{"diffs":[[0,"ToMovie("],[-1,"req.param('"],[0,"imdbId"],[-1,"')"],[0,", review"]],"start1":1468,"start2":1468,"length1":35,"length2":22},{"diffs":[[0,"vie/' + "],[-1,"req.param('"],[0,"imdbId"],[-1,"')"],[0,");\n  });"]],"start1":1539,"start2":1539,"length1":35,"length2":22}]],"length":1564,"saved":false}
{"contributors":[],"silentsave":false,"ts":1376488445722,"patch":[[{"diffs":[[0,");\n\n"],[-1,"/* \n\tShow (movie/:id)\n\tList (movies)\n\tEdit (movie/:id/edit)\n\tUpdate (movie/:id = put)\n\tNew (movie/new)\n\tCreate (movie post)\n\tIndex (/)\n*/\n\n"],[0,"expo"]],"start1":250,"start2":250,"length1":147,"length2":8}]],"length":1425,"saved":false}
{"ts":1376488474366,"patch":[[{"diffs":[[0,"exports."],[-1,"show"],[1,"login"],[0," = funct"]],"start1":254,"start2":254,"length1":20,"length2":21},{"diffs":[[0,") {\n"],[-1,"\treviewProvider.findByImdbId(req.params.imdbId, function(error, movies) {\n    var movie = movies[0];\n      \n    console.log('Showing the following item: ');\n    console.log(movie);\n    console.log('');\n      \n    res.render('movie_show.jade', {\n      title: movie.title,\n      movie: movie\n    });\n\t"],[1,"  res.render('login', { user: req.user, message: req.session.messages "],[0,"});\n"]],"start1":287,"start2":287,"length1":307,"length2":78}]],"length":1197,"saved":false}
{"ts":1376488495473,"patch":[[{"diffs":[[0,"essages });\n};\n\n"],[1,"exports.loginpost = function(req, res, next) {\n  passport.authenticate('local', function(err, user, info) {\n    if (err) { \n      return next(err);\n    }\n    if (!user) {\n      req.session.messages = [info.message];\n      return res.redirect('/login');\n    }\n    req.logIn(user, function(err) {\n      if (err) { \n        return next(err); \n      }\n      return res.redirect('/');\n    });\n  })(req, res, next);\n};\n\n"],[0,"exports.new = fu"]],"start1":353,"start2":353,"length1":32,"length2":446}]],"length":1611,"saved":false}
{"ts":1376488501880,"patch":[[{"diffs":[[0,";\n};"],[-1,"\n\nexports.new = function(req, res) {\t\n  res.render('movie_new.jade', {\n    title: 'New movie'\n  });\n};\n\nexports.create = function(req, res) {\n  var review = {\n    imdbId: req.param('imdbId'),\n    reviews: [{\n      body: req.param('body'),\n      author: req.param('author'),\n      good: req.param('good')\n    }]\n  };\n  \n  movieDataProvider.addMovieData(review, function(error, review) {    \n    reviewProvider.save(review, function(error, review) {\n      res.redirect('/movie/' + review.imdbId);\n    });\n  });\n};\n\n\nexports.addReview = function(req, res) {\n  var imdbId = req.param('imdbId');  \n  var review = {\n    body: req.param('body'),\n    author: req.param('author'),\n    good: req.param('good')\n  };\n  \n  reviewProvider.addReviewToMovie(imdbId, review, function(error, review) {\n    res.redirect('/movie/' + imdbId);\n  });\n};"]],"start1":777,"start2":777,"length1":834,"length2":4}]],"length":781,"saved":false}
{"ts":1376488510363,"patch":[[{"diffs":[[0,"ogin"],[-1,"post"],[0," = f"]],"start1":378,"start2":378,"length1":12,"length2":8}]],"length":777,"saved":false}
{"ts":1376488512539,"patch":[[{"diffs":[[0,"der();\n\nexports."],[1,"show"],[0,"login = function"]],"start1":246,"start2":246,"length1":32,"length2":36}]],"length":781,"saved":false}
{"ts":1376488516307,"patch":[[{"diffs":[[0,"rts.show"],[-1,"l"],[1,"L"],[0,"ogin = f"]],"start1":258,"start2":258,"length1":17,"length2":17}]],"length":781,"saved":false}
{"ts":1376488524082,"patch":[[{"diffs":[[-1,"var ReviewProvider = require('../providers/reviewprovider').ReviewProvider\n  , reviewProvider = new ReviewProvider()\n  \n  , MovieDataProvider = require('../providers/moviedataprovider').MovieDataProvider\n  , movieDataProvider = new MovieDataProvider();\n\n"],[0,"expo"]],"start1":0,"start2":0,"length1":258,"length2":4}]],"length":527,"saved":false}
{"ts":1376488582957,"patch":[[{"diffs":[[1,"var passport = require('passport');\n\n"],[0,"exports.showLogi"]],"start1":0,"start2":0,"length1":16,"length2":53}]],"length":564,"saved":false}
{"contributors":[],"silentsave":false,"ts":1377029225813,"patch":[[{"diffs":[[0,"ort');\n\n"],[-1,"exports."],[1,"var "],[0,"showLogi"]],"start1":29,"start2":29,"length1":24,"length2":20},{"diffs":[[0,"};\n\n"],[-1,"exports."],[1,"var "],[0,"logi"]],"start1":148,"start2":148,"length1":16,"length2":12},{"diffs":[[0,"s, next);\n};"],[1,"\n\nexports.init = function(app) {\n  app.get('/login', showLogin);\n  app.post('/login', login);\n  \n  app.get('/account', ensureAuthenticated, function(req, res){\n  res.render('account', { user: req.user });\n});\n};"]],"start1":544,"start2":544,"length1":12,"length2":223}]],"length":767,"saved":false}
{"ts":1377029254461,"patch":[[{"diffs":[[0,"t);\n};\n\n"],[1,"function ensureAuthenticated(req, res, next) {\n  if (req.isAuthenticated()) { return next(); }\n  res.redirect('/login')\n}\n\n"],[0,"exports."]],"start1":550,"start2":550,"length1":16,"length2":139}]],"length":890,"saved":false}
{"ts":1377029263194,"patch":[[{"diffs":[[0,"ed()) { "],[1,"\n    "],[0,"return n"]],"start1":628,"start2":628,"length1":16,"length2":21},{"diffs":[[0,"next(); "],[-1,"}"],[1,"\n  }\n  "],[0,"\n  res.r"]],"start1":648,"start2":648,"length1":17,"length2":23},{"diffs":[[0,"/login')"],[1,";"],[0,"\n}\n\nexpo"]],"start1":680,"start2":680,"length1":16,"length2":17}]],"length":902,"saved":false}
{"ts":1377029385998,"patch":[[{"diffs":[[0,"eq, res)"],[1," "],[0,"{\n"],[1,"  "],[0,"  res.re"]],"start1":841,"start2":841,"length1":18,"length2":21},{"diffs":[[0,"ser });\n"],[1,"  "],[0,"});\n};"]],"start1":891,"start2":891,"length1":14,"length2":16}]],"length":907,"saved":false}
{"ts":1377029449952,"patch":[[{"diffs":[[0,"t);\n};\n\n"],[1,"function showAccount(req, res) {\n  res.render('account', { user: req.user });\n};\n\n"],[0,"function"]],"start1":550,"start2":550,"length1":16,"length2":98},{"diffs":[[0,"    "],[-1,"res.render('account', { user: req.user });"],[0,"\n  }"]],"start1":934,"start2":934,"length1":50,"length2":8}]],"length":947,"saved":false}
{"ts":1377029461584,"patch":[[{"diffs":[[0,"q.user });\n}"],[-1,";"],[0,"\n\nfunction e"]],"start1":625,"start2":625,"length1":25,"length2":24},{"diffs":[[0,"ed, "],[-1,"function(req, res) {\n    \n  }"],[1,"showAccount"],[0,");\n}"]],"start1":908,"start2":908,"length1":37,"length2":19}]],"length":928,"saved":false}
{"ts":1377029597610,"patch":[[{"diffs":[[0,"er, info) {\n"],[1,"    console.log('in login');\n"],[0,"    if (err)"]],"start1":240,"start2":240,"length1":24,"length2":53}]],"length":957,"saved":false}
{"ts":1377029741510,"patch":[[{"diffs":[[0,"l', "],[-1,"function(err, user, info) {\n    console.log('in login');\n    if (err) { \n      return next(err);\n    }\n    if (!user) {\n      req.session.messages = [info.message];\n      return res.r"],[1,"{ failureR"],[0,"edirect"],[-1,"("],[1,": "],[0,"'/login'"],[-1,");\n    }\n    req.logIn(user, function(err) {\n      if (err) { \n        return next(err); \n      }\n      return res.redirect('/');\n    });\n  })(req, res, next"],[1,", failureFlash: true }),\n  function(req, res) {\n    res.redirect('/');\n  }"],[0,");\n}"]],"start1":220,"start2":220,"length1":364,"length2":109}]],"length":702,"saved":false}
{"ts":1377029751323,"patch":[[{"diffs":[[0,"/');\n  }"],[-1,");"],[0,"\n};\n\nfun"]],"start1":317,"start2":317,"length1":18,"length2":16}]],"length":700,"saved":false}
{"ts":1377029767480,"patch":[[{"diffs":[[0,") {\n"],[-1,"  passport.authenticate('local', { failureRedirect: '/login', failureFlash: true }),\n  function(req, res) {\n  "],[0,"  re"]],"start1":187,"start2":187,"length1":118,"length2":8},{"diffs":[[0,"t('/');\n"],[-1,"  }\n"],[0,"};\n\nfunc"]],"start1":204,"start2":204,"length1":20,"length2":16}]],"length":586,"saved":false}
{"ts":1377029773112,"patch":[[{"diffs":[[0,"/login',"],[1," passport.authenticate('local', { failureRedirect: '/login', failureFlash: true }),"],[0," login);"]],"start1":507,"start2":507,"length1":16,"length2":99}]],"length":669,"saved":false}
{"ts":1377029824444,"patch":[[{"diffs":[[0,"ion(req, res) {\n"],[1,"  res.render('account.jade', {\n      title: movie.title,\n      movie: movie\n    });\n  \n"],[0,"  res.render('lo"]],"start1":58,"start2":58,"length1":32,"length2":119}]],"length":756,"saved":false}
{"ts":1377029841591,"patch":[[{"diffs":[[0,"render('"],[-1,"account"],[1,"login"],[0,".jade', "]],"start1":80,"start2":80,"length1":23,"length2":21},{"diffs":[[0,"    "],[-1," title: movie.title,\n      movie: movie\n    });\n  \n  res.render('login', {"],[0," use"]],"start1":104,"start2":104,"length1":82,"length2":8},{"diffs":[[0,"q.user, "],[1,"\n      "],[0,"message:"]],"start1":117,"start2":117,"length1":16,"length2":23},{"diffs":[[0,"messages"],[1,"\n   "],[0," });\n};\n"]],"start1":153,"start2":153,"length1":16,"length2":20}]],"length":691,"saved":false}
{"contributors":[],"silentsave":false,"ts":1377249694184,"patch":[[{"diffs":[[0,"ssport')"],[1,"\n  , LocalStrategy = require('passport-local').Strategy\n  , User = require('./models/user')"],[0,";\n\nvar s"]],"start1":26,"start2":26,"length1":16,"length2":107},{"diffs":[[0,"(app) {\n"],[1,"  \npassport.use(new LocalStrategy(\n  function(username, password, done) {\n    User.findOne({ username: username }, function(err, user) {\n      if (err) { \n        return done(err); \n      }\n      if (!user) {\n        return done(null, false, { message: 'Incorrect username.' });\n      }\n      if (!user.comparePassword(password)) {\n        return done(null, false, { message: 'Incorrect password.' });\n      }\n      return done(null, user);\n    });\n  }\n));\n\npassport.serializeUser(function(user, done) {\n  done(null, user.id);\n});\n\npassport.deserializeUser(function(id, done) {\n  User.findById(id, function (err, user) {\n    done(err, user);\n  });\n});\n\n  \n  \n"],[0,"  app.ge"]],"start1":568,"start2":568,"length1":16,"length2":675}]],"length":1441,"saved":false}
{"ts":1377249756389,"patch":[[{"diffs":[[0,"p) {\n  \n"],[1,"  "],[0,"passport"]],"start1":571,"start2":571,"length1":16,"length2":18},{"diffs":[[0,"rategy(\n"],[1,"  "],[0,"  functi"]],"start1":605,"start2":605,"length1":16,"length2":18},{"diffs":[[0,") {\n    "],[1,"  "],[0,"User.fin"]],"start1":650,"start2":650,"length1":16,"length2":18},{"diffs":[[0,"er) {\n      "],[1," "],[1," "],[0,"if (err) { \n"]],"start1":713,"start2":713,"length1":24,"length2":26},{"diffs":[[0,"if (err) { \n"],[1,"  "],[0,"        retu"]],"start1":727,"start2":727,"length1":24,"length2":26},{"diffs":[[0,"rr); \n      "],[1,"  "],[0,"}\n      "],[1," "],[1," "],[0,"if (!user) {"]],"start1":762,"start2":762,"length1":32,"length2":36},{"diffs":[[0,"   if (!user) {\n"],[1,"  "],[0,"        return d"]],"start1":783,"start2":783,"length1":32,"length2":34},{"diffs":[[0,"' });\n      "],[-1,"}\n"],[1,"  }\n  "],[0,"      if (!u"]],"start1":865,"start2":865,"length1":26,"length2":30},{"diffs":[[0,"ord)) {\n        "],[1,"  "],[0,"return done(null"]],"start1":920,"start2":920,"length1":32,"length2":34},{"diffs":[[0,"' });\n      "],[-1,"}\n"],[1,"  }\n  "],[0,"      return"]],"start1":994,"start2":994,"length1":26,"length2":30},{"diffs":[[0,"    "],[1,"  "],[0,"});\n  "],[1,"  "],[0,"}"],[-1,"\n"],[0,"));\n"],[-1,"\n"],[1,"  \n  "],[0,"pass"]],"start1":1043,"start2":1043,"length1":21,"length2":28},{"diffs":[[0,"done) {\n"],[1,"  "],[0,"  done(n"]],"start1":1105,"start2":1105,"length1":16,"length2":18},{"diffs":[[0,"er.id);\n"],[1,"  "],[0,"});\n"],[-1,"\n"],[1,"  \n  "],[0,"passport"]],"start1":1130,"start2":1130,"length1":21,"length2":27},{"diffs":[[0,"done) {\n"],[1,"  "],[0,"  User.f"]],"start1":1187,"start2":1187,"length1":16,"length2":18},{"diffs":[[0,"user) {\n    "],[1,"  "],[0,"done(err, us"]],"start1":1232,"start2":1232,"length1":24,"length2":26},{"diffs":[[0," user);\n"],[1,"  "],[0,"  });\n"],[1,"  "],[0,"});\n\n  \n"]],"start1":1255,"start2":1255,"length1":22,"length2":26}]],"length":1490,"saved":false}
{"ts":1377249759209,"patch":[[{"diffs":[[0,"    });\n"],[-1,"  "],[0,"  }));\n "]],"start1":1045,"start2":1045,"length1":18,"length2":16}]],"length":1488,"saved":false}
{"ts":1377249762437,"patch":[[{"diffs":[[0,"  });\n  "],[-1,"}"],[1,"  }\n  "],[0,"));\n  \n "]],"start1":1047,"start2":1047,"length1":17,"length2":22}]],"length":1493,"saved":false}
{"ts":1377249767544,"patch":[[{"diffs":[[0,");\n  });"],[-1,"\n\n"],[0,"  \n  \n  "]],"start1":1271,"start2":1271,"length1":18,"length2":16}]],"length":1491,"saved":false}
{"ts":1377250835712,"patch":[[{"diffs":[[0,"'account"],[1,".jade"],[0,"', { use"]],"start1":375,"start2":375,"length1":16,"length2":21}]],"length":1496,"saved":false}
{"ts":1377250855578,"patch":[[{"diffs":[[0,"quire('."],[1,"."],[0,"/models/"]],"start1":103,"start2":103,"length1":16,"length2":17}]],"length":1497,"saved":false}
{"ts":1377263238599,"patch":[[{"diffs":[[0,") {\n"],[-1,"  \n  passport.use(new LocalStrategy(\n    function(username, password, done) {\n      User.findOne({ username: username }, function(err, user) {\n        if (err) { \n          return done(err); \n        }\n        if (!user) {\n          return done(null, false, { message: 'Incorrect username.' });\n        }\n        if (!user.comparePassword(password)) {\n          return done(null, false, { message: 'Incorrect password.' });\n        }\n        return done(null, user);\n      });\n    }\n  ));\n  \n  passport.serializeUser(function(user, done) {\n    done(null, user.id);\n  });\n  \n  passport.deserializeUser(function(id, done) {\n    User.findById(id, function (err, user) {\n      done(err, user);\n    });\n  });  \n  \n"],[0,"  ap"]],"start1":578,"start2":578,"length1":717,"length2":8}]],"length":788,"saved":false}
{"ts":1377263243817,"patch":[[{"diffs":[[0,"rt')"],[-1,"\n  , LocalStrategy = require('passport-local').Strategy\n  , User = require('../models/user')"],[0,";\n\nv"]],"start1":30,"start2":30,"length1":100,"length2":8}]],"length":696,"saved":false}
{"ts":1377263795343,"patch":[[{"diffs":[[0,"n', "],[-1,"passport.authenticate('local', { failureRedirect: '/login', failureFlash: true })"],[0,", lo"]],"start1":539,"start2":539,"length1":89,"length2":8}]],"length":615,"saved":false}
{"ts":1377263837802,"patch":[[{"diffs":[[0,"passport"],[1,"Wrapper"],[0," = requi"]],"start1":4,"start2":4,"length1":16,"length2":23},{"diffs":[[0,"equire('"],[1,"../infrastructure/"],[0,"passport"],[1,"wrapper"],[0,"');\n\nvar"]],"start1":23,"start2":23,"length1":24,"length2":49}]],"length":647,"saved":false}
{"ts":1377263841557,"patch":[[{"diffs":[[0,"login', "],[1,"passportWrapper"],[0,", login)"]],"start1":567,"start2":567,"length1":16,"length2":31}]],"length":662,"saved":false}
{"ts":1377263853682,"patch":[[{"diffs":[[0,"tWrapper"],[1,".authenticate()"],[0,", login)"]],"start1":582,"start2":582,"length1":16,"length2":31}]],"length":677,"saved":false}
{"ts":1377263868803,"patch":[[{"diffs":[[0,"enticate"],[-1,"()"],[0,", login)"]],"start1":595,"start2":595,"length1":18,"length2":16}]],"length":675,"saved":false}
{"ts":1377264773400,"patch":[[{"diffs":[[0,"n');\n}\n\n"],[1,"function logout(req, res){\n  req.logout();\n  res.redirect('/');\n}\n\n"],[0,"exports."]],"start1":483,"start2":483,"length1":16,"length2":83},{"diffs":[[0,"in);\n  \n"],[1,"  app.get('/logout', function(req, res){\n  req.logout();\n  res.redirect('/');\n});\n  \n"],[0,"  app.ge"]],"start1":675,"start2":675,"length1":16,"length2":101}]],"length":827,"saved":false}
{"ts":1377264777971,"patch":[[{"diffs":[[0,"t', "],[-1,"function(req, res){\n  req.logout();\n  res.redirect('/');\n}"],[1,"logout"],[0,");\n "]],"start1":700,"start2":700,"length1":66,"length2":14}]],"length":775,"saved":false}
{"ts":1377264807237,"patch":[[{"diffs":[[0,"\n}\n\n"],[-1,"function ensureAuthenticated(req, res, next) {\n  if (req.isAuthenticated()) { \n    return next(); \n  }\n  \n  res.redirect('/login');\n}\n\n"],[0,"func"]],"start1":352,"start2":352,"length1":143,"length2":8}]],"length":640,"saved":false}
{"ts":1377264841517,"patch":[[{"diffs":[[0,"count', "],[1,"passportWrapper."],[0,"ensureAu"]],"start1":595,"start2":595,"length1":16,"length2":32}]],"length":656,"saved":false}
{"ts":1377264860026,"patch":[[{"diffs":[[0,"');\n};\n\n"],[1,"function logout(req, res){\n  req.logout();\n  res.redirect('/');\n}\n\n"],[0,"function"]],"start1":262,"start2":262,"length1":16,"length2":83},{"diffs":[[0,"\n}\n\n"],[-1,"function logout(req, res){\n  req.logout();\n  res.redirect('/');\n}\n\n"],[0,"expo"]],"start1":419,"start2":419,"length1":75,"length2":8}]],"length":656,"saved":false}
